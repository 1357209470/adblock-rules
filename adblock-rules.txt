
# 终极完整版广告拦截规则（精准版：全广告特征+极低误伤）
# ==============================================
# SCRIPT 脚本类（仅拦截明确广告脚本，移除统计/分析脚本）
# ==============================================
# 核心广告脚本（精准匹配，避免误伤正常脚本）
script[src*="-ad.js"]
script[src*="ad-script.js"]
script[src*="banner-ad.js"]
script[src*="popup-ad.js"]
script[src*="slide-ad.js"]
script[src*="modal-ad.js"]
script[src*="advert.js"]
script[src*="linkbucks.js"]
script[src*="adf.ly.js"]
script[src*="adsbygoogle.js"]
script[src*="adtrack.js"]
script[src*="adserver.js"]
script[src*="ads-loader.js"]
script[src*="load-ad.js"]
script[src*="video-ad.js"]
script[src*="expandable-ad.js"]
# 广告特征词脚本（精准化，增加广告专属前缀/后缀）
script[src*="sponsored-ad.js"]
script[src*="promoted-ad.js"]
script[src*="affiliate-ad.js"]
script[src*="native-ad.js"]
script[src*="interstitial-ad.js"]
script[src*="push-ad.js"]
script[src*="notification-ad.js"]
script[src*="ad-pixel.js"]
script[src*="ad-beacon.js"]
script[src*="ad-tracker.js"]
# 脚本内容匹配（仅匹配广告专属关键词）
script:contains("adCode")
script:contains("advertisementId")
script:contains("trackAdImpression")
script:contains("sendAdClickEvent")

# ==============================================
# CLASS 类名类（精准匹配广告专属类名，避免匹配admin/address等）
# ==============================================
# 核心广告类名（仅匹配以ad-开头/包含-ad-的类名）
DIV[class^="ad-"]
DIV[class^="ads-"]
DIV[class*="-ad-"]
DIV[class*="gif-ad-"]
DIV[class*="ad-embed-"]
DIV[class*="display-ad-"]
DIV[class*="sidebar-ad-"]
DIV[class*="sticky-ad-"]
DIV[class*="floating-ad-"]
DIV[class*="fullscreen-ad-"]
DIV[class*="ad-interstitial-"]
# 广告特征词类名（精准化，避免通用词汇误伤）
DIV[class^="sponsored-"]
DIV[class^="promoted-"]
DIV[class^="affiliate-"]
DIV[class^="native-ad-"]
DIV[class^="interstitial-"]
DIV[class*="sponsored-ad-"]
DIV[class*="promoted-ad-"]
DIV[class*="affiliate-ad-"]
DIV[class*="ad-skip-"]
DIV[class*="ad-close-"]
DIV[class*="ad-container-"]
DIV[class*="ad-wrapper-"]

# ==============================================
# IFRAME 框架类（仅拦截明确广告框架）
# ==============================================
iframe[name^="ad-"]
iframe[name^="ads-"]
iframe[src*="ads.com/"]
iframe[src*="advertising.com/"]
iframe[src*="adnetwork."]
iframe[src*="adexchange."]
iframe[src*="adserver."]
iframe[src*="adroll."]
iframe[src*="taboola."]
iframe[src*="outbrain."]
# 精准化广告特征词
iframe[name^="sponsored-"]
iframe[name^="promoted-"]
iframe[src*="sponsored-ad."]
iframe[src*="native-ad."]

# ==============================================
# ID 标识类（精准匹配广告专属ID）
# ==============================================
DIV[id^="ad-"]
DIV[id^="ads-"]
DIV[id*="-ad-"]
DIV[id*="floating-ad-"]
DIV[id*="popup-ad-"]
DIV[id*="ad-interstitial-"]
DIV[id*="ad-sponsored-"]
DIV[id*="ad-skip-"]
DIV[id*="ad-close-"]
# 广告特征词ID
DIV[id^="sponsored-"]
DIV[id^="promoted-"]
DIV[id*="sponsored-ad-"]
DIV[id*="promoted-ad-"]

# ==============================================
# VIDEO 视频类（精准匹配视频广告）
# ==============================================
.video-ad
.ad-video
video[src*="-ad."]
video[src*="sponsored-ad."]
video[src*="promoted-ad."]
[class*="-ad-video-"]
[id*="-ad-video-"]
.video-ad-wrapper
.video-ad-container
.video-ad-skip

# ==============================================
# A 链接类（增加广告特征+移除过度严格的nofollow判断）
# ==============================================
a[href*="?ad_id="]
a[href*="/ad/"]
a[href*="ad_link="]
a[href*="buyad/"]
a[href*="advertisement/"]
# 精准化广告链接特征
a[href*="sponsored-ad/"]
a[href*="promoted-ad/"]
a[href*="affiliate-ad/"]
a[class^="ad-link-"]
a[class^="sponsored-link-"]
a[id^="ad-link-"]
# 优化target判断：增加广告特征+nofollow组合
a[target="_blank"][href*="/ad/"][rel!="nofollow"]
a[target="_blank"][href*="sponsored-ad/"][rel!="nofollow"]

# ==============================================
# BUTTON 按钮类（仅匹配广告专属按钮）
# ==============================================
button[class^="ad-button-"]
button[class^="skip-ad-"]
button[class^="ad-close-"]
button[class^="ad-hide-"]
button[class^="sponsored-btn-"]
button[id^="ad-close-"]
button[id^="ad-skip-"]

# ==============================================
# AJAX 请求类（仅拦截广告专属请求）
# ==============================================
xhr-req[src*="ads/api/"]
xhr-req[src*="adclick/"]
xhr-req[src*="adload/"]
xhr-req[src*="popup-ad/"]
xhr-req[src*="ad-impression/"]
xhr-req[src*="ad-click/"]
xhr-req[src*="sponsored-ad/api/"]

# ==============================================
# IMG 图片类（精准匹配广告图片，移除1x1像素误伤）
# ==============================================
img[src*="-ad."]
img[src*="ad-banner."]
img[src*="popup-ad."]
img[src*="sponsored-ad."]
img[class^="ad-"]
img[class*="-ad-"]
img[id^="ad-"]
img[id*="-ad-"]
img[alt*="广告"][alt!="广告说明"]
img[alt*=" Sponsored "][alt!="Sponsored Content"]

# ==============================================
# FORM 表单类（精准匹配广告表单）
# ==============================================
form[action*="/ad/"]
form[action*="sponsored-ad/"]
form[class^="ad-form-"]
form[id^="ad-form-"]
input[name^="ad_"]
input[name*="_ad_"]
input[name^="sponsored_ad_"]

# ==============================================
# STYLE 样式类（仅拦截广告专属样式）
# ==============================================
style:contains(".ad-")
style:contains("#ad-")
style:contains(".sponsored-ad")
link[rel="stylesheet"][href*="-ad.css"]
link[rel="stylesheet"][href*="ad-style.css"]

# ==============================================
# WEBSOCKET 类（仅拦截广告专属WS）
# ==============================================
websocket[url*="ad-tracker/"]
websocket[url*="ad-pixel/"]
websocket[url*="sponsored-ad/"]

# ==============================================
# COOKIE 类（仅拦截广告专属Cookie）
# ==============================================
cookie[name^="ad_"]
cookie[name^="ads_"]
cookie[name*="_ad_"]
cookie[name*="ad_tracker_"]
cookie[name*="sponsored_ad_"]

# ==============================================
# MEDIA 音频类（精准匹配广告音频）
# ==============================================
audio[src*="-ad."]
audio[class^="ad-audio-"]
audio[id^="ad-audio-"]
.audio-ad
.ad-audio
.sponsored-audio

# ==============================================
# FRAMESET 框架类（精准匹配广告框架）
# ==============================================
frameset:has(frame[src*="-ad.html"])
frameset:has(frame[src*="sponsored-ad.html"])
frame[src*="-ad.html"]
frame[src*="sponsored-ad.html"]


# 广告拦截规则补充：常见广告词与广告特征（零误伤版）
# ==============================================
# 一、中文广告专属特征词（正常网站几乎不会使用）
# ==============================================
# 1. 中文广告标签标识
*[class*="广告-"]
*[id*="广告-"]
*[data-type="广告"]
*[data-ad-type]
*[data-promotion]
*[data-sponsored]
*[title*="广告"]:not([title*="广告说明"]):not([title*="广告位"])
*[alt*="广告"]:not([alt*="广告图片示例"])
*[text*="广告"]:not([text*="广告法"]):not([text*="广告投放"])
*[aria-label*="广告"]

# 2. 中文推广/赞助标识
*[class*="推广-"]
*[id*="推广-"]
*[class*="赞助商-"]
*[id*="赞助商-"]
*[data-ad="推广"]
*[data-sponsor="true"]
*[text*="推广"]:not([text*="推广活动"]):not([text*="推广员"])
*[text*="赞助商"]:not([text*="官方赞助商"])

# 3. 中文信息流广告特征
*[class*="信息流广告"]
*[class*="推荐广告"]
*[class*="相关推荐-广告"]
*[id*="feed-ad"]
*[id*="recommended-ad"]
*[data-feed-type="ad"]

# ==============================================
# 二、英文广告专属特征词（国际通用，避免匹配正常词汇）
# ==============================================
# 1. 广告专属前缀/后缀模式
*[class^="ad_"]
*[class$="_ad"]
*[class*="__ad__"]
*[id^="ad_"]
*[id$="_ad"]
*[id*="__ad__"]
*[name^="ad_"]
*[name$="_ad"]

# 2. 原生广告/赞助内容特征
*[class*="native-ad-"]
*[class*="sponsored-content-"]
*[class*="promoted-content-"]
*[data-native-ad]
*[data-sponsored-content]
*[data-promoted-content]
*[href*="sponsored-content"]:not([rel="nofollow"])
*[href*="promoted-content"]:not([rel="nofollow"])

# 3. 广告平台专属特征（Google、Facebook、百度等）
*[class*="adsbygoogle"]
*[class*="gpt-ad"]
*[class*="google-ad-"]
*[class*="fb-ad-"]
*[class*="baidu-ad-"]
*[class*="toutiao-ad-"]
*[data-ad-client]
*[data-ad-slot]
*[data-ad-format]
*[data-mu]  # 百度推广特征
*[data-tu]  # 百度推广特征

# ==============================================
# 三、广告行为特征词（仅广告会使用的交互元素）
# ==============================================
# 1. 广告跳过/关闭特征
*[class*="ad-skip-button"]
*[class*="ad-close-button"]
*[class*="ad-dismiss-"]
*[id*="ad-skip"]
*[id*="ad-close"]
*[aria-label*="跳过广告"]
*[aria-label*="关闭广告"]
*[text*="跳过广告"]
*[text*="关闭广告"]

# 2. 广告倒计时特征（正常网站几乎不用）
*[class*="ad-countdown-"]
*[id*="ad-countdown"]
*[data-countdown-type="ad"]
*[text*="广告倒计时"]
*[text*="秒后关闭广告"]

# 3. 广告交互特征（点击/转化/追踪）
*[onclick*="trackAdClick"]
*[onclick*="sendAdConversion"]
*[onclick*="adRedirect"]
*[data-ad-click]
*[data-ad-impression]
*[data-ad-conversion]

# ==============================================
# 四、新兴广告形式特征（原生/插屏/弹窗/推送）
# ==============================================
# 1. 插屏广告特征
*[class*="interstitial-ad-"]
*[id*="interstitial-ad"]
*[data-interstitial-ad]
*[style*="position:fixed"][style*="top:0"][style*="left:0"][style*="width:100%"][style*="height:100%"]:has(*[class*="ad"])

# 2. 推送广告特征
*[class*="push-ad-"]
*[id*="push-ad"]
*[data-push-ad]
*[class*="notification-ad-"]
*[id*="notification-ad"]
*[data-notification-ad]

# 3. 弹窗广告特征（精准匹配，避免误伤正常弹窗）
*[class*="popup-ad-"]
*[id*="popup-ad"]
*[data-popup-ad]
*[class*="modal-ad-"]
*[id*="modal-ad"]
*[data-modal-ad]
*[role="dialog"][class*="ad"]

# ==============================================
# 五、广告资源加载特征（请求URL专属模式）
# ==============================================
# 1. 广告图片/视频URL特征
*[src*="/ad-image/"]
*[src*="/ad-video/"]
*[src*="/ad-assets/"]
*[src*="?ad-image="]
*[src*="?ad-video="]
*[src*="ad-creative."]
*[src*="ad-assets."]

# 2. 广告API请求特征
*[src*="/ad-api/"]
*[src*="/ad-service/"]
*[src*="/ad-delivery/"]
*[src*="/ad-targeting/"]
*[src*="/ad-personalization/"]

# 3. 广告追踪请求特征（增加ad-前缀，避免匹配正常track）
*[src*="/ad-track/"]
*[src*="/ad-pixel/"]
*[src*="/ad-beacon/"]
*[src*="/ad-retarget/"]

# ==============================================
# 六、广告特殊样式特征（仅广告使用的CSS模式）
# ==============================================
# 1. 悬浮广告样式（正常网站极少使用）
*[style*="position:fixed"][style*="z-index:9999"][class*="ad"]
*[style*="position:sticky"][class*="ad"]
*[style*="position:absolute"][style*="top:0"][style*="right:0"][class*="ad"]

# 2. 全屏广告样式
*[style*="width:100vw"][style*="height:100vh"][class*="ad"]
*[style*="width:100%"][style*="height:100%"][class*="ad"][style*="position:fixed"]

# ==============================================
# 七、广告表单/按钮专属特征
# ==============================================
# 1. 广告表单特征
form[class*="ad-form-"]
form[id*="ad-form-"]
form[action*="/ad-submit/"]
form[action*="/ad-click/"]
input[name*="ad_form_"]
input[name*="ad_click_"]

# 2. 广告按钮特征
button[class*="ad-cta-"]  # CTA: Call To Action
button[class*="ad-action-"]
button[class*="ad-submit-"]
button[id*="ad-cta"]
button[id*="ad-action"]
button[aria-label*="广告"][aria-label*="按钮"]

《自定义》

||cdn.r18.top
||gx.js.mlhepai.com
||fonts.googleapis.com
||media.ethicalads.io
||cdn.leisu.com
||pstatp.com$~3p
||cdn.jsdelivr.net/*.gif
||bdstatic.com$~3p
||cdn.bcebos.com$~3p
||qchannel03.cn
||res.wx.qq.com
||dl.btii.cn/zclz/lz001
||cdn.miaosdk.com
||b10.justacdn.net^
||we.561290.xyz^
||api.qiumibao.com
/yingshiyihao/img/load.gif
/template/jable/statics/js/app.js$~3p
##DIV.bootom-fixed
zhibo8.com##DIV.top-header,A.btn-open
hupu.com##DIV.tabs-component-search,DIV.tabs-component-occu-1,SECTION.footer
##IMG[alt][style='width: 100%; height: 100%;']
##DIV.lists-content
##DIV.react-component.i-bem.react-component_js_inited
##DIV.images-viewer-content2__behavioral-direct
##DIV#fage_hf
##A.banner
##DIV#boottom-float-adv
##DIV.boottom-downloadapp
##DIV.shuoqiudiAPP
##DIV.boottom-banner
##DIV.fixed.right-2.boottom-2
##DIV.mvspan_2_s_k_i_p_row
##DIV.popup
##DIV.di_img
##DIV#ad-container
a.rezhibo8.com##DIV.popupdirect-ad
##DIV.mobile-download-popup
##DIV.fixed.right-2.bottom-2
##DIV#io-popup-tips
##A.mobile-download-frame
##DIV.banner
##DIV.search-ad
##DIV.loading-ad
##DIV.preload-ad
##DIV.waplist
##DIV.hidden-content
##DIV.adx-bottom-fixed
##SPAN.androidKJ-btn_w_img
##DIV.article-feedback-c-double
##DIV.hl-pops-bg.hl-pops-bg-active
##DIV[align='center']
hermes.hupu.com/h.gif@m.hupu.com
##DIV.ut1_img_content,DIV.ut1_img_content_js,DIV.ut1_img_ex_content
##DIV.ut1_img
##A[href^='/go.php'][ref='nofollow'][target='_blank']
##UL.mb-4.list-none.text-nord14.grid.grid-cols-2.gap-2
##DIV.pop-box,DIV.box-bg
www.duplichecker.com##img.img-responsive
绅士漫画
/ssmh/*.gif
mo/images/bg_head_*.png
mo/images/bg_head_*.gif
##ul#classify_container > li.cate-0
##div[class*="mobile-download-popup"]
##AppBanner
